
var webpack = require('webpack')
var config = require('./webpack.config')

var fs = require('fs');

module.exports = {
  entry: {
    main: [
      './src/main'
    ]
  },
  output: {
    path: 'build/',
    filename: '[name].[chunkhash].js',
    publicPath: './build/'
  },
  resolve: config.resolve,
  module: config.module,
  plugins: [
    new webpack.optimize.UglifyJsPlugin({
      sourceMap: false
    }),
    function() {
      this.plugin('done', function(stats) {
        content = JSON.stringify(stats.toJson().assetsByChunkName, null, 2)
        return fs.writeFileSync('build/assets.json', content)
      })
    }
  ]
}
